<!doctype html>
<html lang='en-US'>
  <head>
    <meta charset='utf-8'>
    <link rel='stylesheet' type='text/css' href='qrc:///style.css'>
    <script src='qrc:///qwebchannel.js'></script>
  </head>

  <body>
    <div id='placeholder'></div>

    <script>
        'use strict';
        var placeholder = document.getElementById('placeholder');

        function updateMessage(text) {
            placeholder.innerHTML = text;
            placeholder.classList.add('error');
            placeholder.classList.remove('tree');
        }

        function updateTree(text) {
            placeholder.classList.add('tree');
            placeholder.classList.remove('error');
            placeholder.innerHTML = text;
        }

        new QWebChannel(
            qt.webChannelTransport,
            function(channel) {
                var message_handler = channel.objects.message_handler,
                    tree_handler = channel.objects.tree_handler;
                updateMessage(message_handler.text);
                message_handler.textChanged.connect(updateMessage);
                tree_handler.treeChanged.connect(updateTree);
            }
        );
    </script>

  </body>
</html>
